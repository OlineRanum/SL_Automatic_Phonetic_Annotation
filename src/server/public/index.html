<!-- public/index.html -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Phonetic Modelling</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Phonetic Modelling</h1>

    <!-- Tab Buttons -->
    <div class="tab">
        <button class="tablinks active" onclick="openTab(event, 'DataViewer')">Data Viewer</button>
        <button class="tablinks" onclick="openTab(event, 'ReferencePosesViewer')">Reference Poses Viewer</button>
        <button class="tablinks" onclick="openTab(event, 'AllNotes')">All Notes</button> <!-- New Tab -->
        <button class="tablinks" onclick="openTab(event, 'MoCap')">3D MoCap</button>

    </div>

    <!-- Tab Content: Data Viewer -->
    <div id="DataViewer" class="tabcontent active">
        <div class="data-viewer-container">
            <!-- GIF Viewer Section -->
            <div class="gif-viewer">
                <h2>GIF Viewer</h2>
                <select id="gif-select">
                    <option value="">--Select a GIF--</option>
                    <!-- Options will be populated dynamically -->
                </select>
                <div id="loading" style="display: none;">
                    Loading...
                    <div id="progress-container">
                        <div id="progress-bar"></div>
                    </div>
                </div>
                <div class="frame-display">
                    <img id="gif-image" src="" alt="Selected GIF Frame">
                    <div id="frame-info">Frame: 0</div>
                </div>
                <div class="controls">
                    <button id="prev-btn" disabled>Previous Frame</button>
                    <button id="next-btn" disabled>Next Frame</button>
                    <button id="toggle-play-btn" disabled>Play GIF</button>
                    <label for="frame-rate">Frame Rate (ms):</label>
                    <input type="number" id="frame-rate" value="200" min="10" max="1000">
                </div>
            </div>

            <!-- Note-Taking Section -->
            <div class="note-taking">
                <h2>Frame Notes</h2>
                <textarea id="note-input" placeholder="Write your note here..."></textarea>
                <button id="save-note-btn">Save Note</button>

                <div id="notes-list">
                    <!-- Notes will be dynamically added here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Tab Content: Reference Poses Viewer -->
    <div id="ReferencePosesViewer" class="tabcontent">
        <div class="reference-poses-layout">
            <!-- Left Column: Checkboxes and Clear All Button -->
            <div class="pose-selection">
                <label>Select Reference Poses:</label>
                <button id="clear-all-btn">Clear All</button>
                <div id="pose-select-container">
                    <!-- Checkboxes will be dynamically added here -->
                </div>
            </div>

            <!-- Right Column: Pose Display -->
            <div class="pose-display">
                <div id="pose-loading" style="display: none;">
                    Loading pose images...
                </div>
                <div id="reference-poses-container">
                    <!-- Multiple images will be displayed here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Tab Content: 3D MoCap -->
    <div id="MoCap" class="tabcontent">
        <h2>3D MoCap Reference Handshapes</h2>
        <div class="gif-viewer-container">

        <div class="gif-viewer">
            <h3>GIF Loader</h3>
            <select id="mocap-gif-select">
                <option value="">--Select a GIF--</option>
                <!-- Options will be dynamically populated -->
            </select>
            <div id="mocap-loading" style="display: none;">
                Loading...
                <div id="mocap-progress-container">
                    <div id="mocap-progress-bar"></div>
                </div>
            </div>
            <div class="frame-display">
                <img id="mocap-gif-image" src="" alt="Selected GIF Frame">
                <div id="mocap-frame-info">Frame: 0</div>
            </div>
            <div class="controls">
                <button id="mocap-prev-btn" disabled>Previous Frame</button>
                <button id="mocap-next-btn" disabled>Next Frame</button>
                <button id="mocap-toggle-play-btn" disabled>Play GIF</button>
                <label for="mocap-frame-rate">Frame Rate (ms):</label>
                <input type="number" id="mocap-frame-rate" value="200" min="10" max="1000">
            </div>
        </div>
        <!-- In the MoCap tab, perhaps below or next to the .gif-viewer -->
        <div class="gif-viewer">
        <div class="mocap-selected-frames-tools" style="margin-top: 20px;">
            <h3>Store Frame Indexes</h3>
            <label for="mocap-frame-input">Single or Range:</label>
            <input type="text" id="mocap-frame-input" placeholder="e.g. 210 or 211-234">
        
            <button id="mocap-save-frames-btn">Save</button>
        
            <div id="mocap-saved-frames-list" style="margin-top: 10px;">
            <!-- Weâ€™ll display the currently stored frames for the selected MoCap GIF here -->
            </div>
        </div>
        <div class="mocap-remove-frames-section" style="margin-top: 10px;">
            <label for="mocap-remove-input">Remove Range:</label>
            <input type="text" id="mocap-remove-input" placeholder="e.g. 211-234">
            <button id="mocap-remove-frames-btn">Remove Range</button>
          </div>
        </div>
          
    </div>
    </div>

    <!-- Tab Content: All Notes -->
    <div id="AllNotes" class="tabcontent">
        <h2>All Notes</h2>
        <button id="update-all-notes-btn">Update Notes</button> <!-- Added Update Button -->
        <div id="all-notes-list"></div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <!-- Scripts -->
    <script src="script.js"></script>

    <!-- Add the openTab function -->
    <script>
        function openTab(evt, tabName) {
            // Declare all variables
            var i, tabcontent, tablinks;

            // Get all elements with class="tabcontent" and hide them
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
                tabcontent[i].classList.remove('active');
            }

            // Get all elements with class="tablinks" and remove the class "active"
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }

            // Show the current tab, and add an "active" class to the button that opened the tab
            document.getElementById(tabName).style.display = "block";
            document.getElementById(tabName).classList.add('active');
            evt.currentTarget.className += " active";

            // Trigger specific behavior for the MoCap tab, if needed
            if (tabName === 'MoCap') {
                // Optionally add functionality here
                console.log('3D MoCap Tab Activated');
                fetchMoCapGifs();
            }
            
        }
    </script>
</body>
</html>
